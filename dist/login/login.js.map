{"version":3,"file":"login.js","sourceRoot":"","sources":["../../src/login/login.ts"],"names":[],"mappings":"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","sourcesContent":["import {LitElement, html} from 'lit';\nimport {customElement, query} from 'lit/decorators.js';\nimport {User} from '../model';\n\n@customElement('app-login')\nexport class Login extends LitElement {\n  private inputForm: {\n    username?: string;\n    password?: string;\n  } = {};\n\n  @query('#username')\n  _username: HTMLInputElement | undefined;\n\n  @query('#pass')\n  _password: HTMLInputElement | undefined;\n\n  override createRenderRoot() {\n    return this;\n  }\n\n  override connectedCallback(): void {\n    const token: string | null = localStorage.getItem('token');\n    if (token != null) {\n      const requestOptions: RequestInit = {\n        method: 'GET',\n        redirect: 'follow',\n      };\n      fetch(`http://localhost:8081/verifyToken?token=${token}`, requestOptions)\n        .then((response) => response.json())\n        .then((result: {token: string; user: User}) => {\n          localStorage.setItem('token', result.token);\n          localStorage.setItem('user', JSON.stringify(result.user));\n          window.location.href = '/rtcapp/home.html';\n        })\n        .catch((error) => console.log('error', error));\n    }\n    super.connectedCallback();\n  }\n\n  login() {\n    this.inputForm.username = this._username?.value;\n    this.inputForm.password = this._password?.value;\n    const myHeaders = new Headers();\n    myHeaders.append('Content-Type', 'application/json');\n    const raw = JSON.stringify({\n      username: `${this.inputForm.username}`,\n      password: `${this.inputForm.password}`,\n    });\n    const requestOptions: RequestInit = {\n      method: 'POST',\n      headers: myHeaders,\n      body: raw,\n      redirect: 'follow',\n    };\n    console.log(JSON.stringify(raw));\n    fetch('http://localhost:8081/login', requestOptions)\n      .then((response) => response.json())\n      .then((result: {token: string; user: User}) => {\n        localStorage.setItem('token', result.token);\n        localStorage.setItem('user', JSON.stringify(result.user));\n        window.location.href = '/rtcapp/home.html';\n      })\n      .catch((error) => console.log('error', error));\n  }\n\n  toggleForm() {\n    const registerForm = new CustomEvent('toggleForm', {\n      detail: {message: ''},\n      bubbles: true,\n      composed: true,\n    });\n    this.dispatchEvent(registerForm);\n  }\n\n  override render() {\n    return html`\n      <p class=\"text-center h3 fw-bold mb-5 mx-1 mx-md-4 mt-4\">Login</p>\n\n      <form class=\"mx-1 mx-md-4\">\n        <div class=\"d-flex flex-row align-items-center mb-4\">\n          <i class=\"fas fa-user fa-lg me-3 fa-fw\"></i>\n          <div class=\"form-outline flex-fill mb-0\">\n            <input required type=\"text\" id=\"username\" class=\"form-control\" />\n            <label class=\"form-label\" for=\"username\">User Name</label>\n          </div>\n        </div>\n\n        <div class=\"d-flex flex-row align-items-center mb-4\">\n          <i class=\"fas fa-lock fa-lg me-3 fa-fw\"></i>\n          <div class=\"form-outline flex-fill mb-0\">\n            <input required type=\"password\" id=\"pass\" class=\"form-control\" />\n            <label class=\"form-label\" for=\"pass\">Password</label>\n          </div>\n        </div>\n\n        <div class=\"d-flex justify-content-center mx-4 mb-3 mb-lg-4\">\n          <button\n            type=\"button\"\n            class=\"btn btn-primary btn-lg me-4\"\n            @click=\"${this.login}\"\n          >\n            <i class=\"fas fa-sign-in-alt fa-lg me-3 fa-fw\"></i>\n            Login\n          </button>\n          <button\n            type=\"button\"\n            class=\"btn btn-secondary btn-lg\"\n            @click=\"${this.toggleForm}\"\n          >\n            <i class=\"fas fa-user-plus fa-lg me-3 fa-fw\"></i>\n            Register\n          </button>\n        </div>\n      </form>\n    `;\n  }\n}\n"]}